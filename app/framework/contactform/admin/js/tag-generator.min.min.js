(function(b){if(typeof wpcf7==="undefined"||wpcf7===null){return}wpcf7.taggen={};b(function(){b("form.tag-generator-panel").each(function(){wpcf7.taggen.update(b(this))})});b("form.tag-generator-panel").submit(function(){return false});b("form.tag-generator-panel .control-box :input").change(function(){var a=b(this).closest("form.tag-generator-panel");wpcf7.taggen.normalize(b(this));wpcf7.taggen.update(a)});b("input.insert-tag").click(function(){var d=b(this).closest("form.tag-generator-panel");var a=d.find("input.tag").val();wpcf7.taggen.insert(a);tb_remove();return false});wpcf7.taggen.update=function(a){var f=a.attr("data-id");var h="";var g=a.find('input[name="name"]');if(g.length){h=g.val();if(""===h){h=f+"-"+Math.floor(Math.random()*1000);g.val(h)}}if(b.isFunction(wpcf7.taggen.update[f])){return wpcf7.taggen.update[f].call(this,a)}a.find("input.tag").each(function(){var d=b(this).attr("name");if(a.find(':input[name="tagtype"]').length){d=a.find(':input[name="tagtype"]').val()}if(a.find(':input[name="required"]').is(":checked")){d+="*"}var c=wpcf7.taggen.compose(d,a);b(this).val(c)});a.find("span.mail-tag").text("["+h+"]");a.find("input.mail-tag").each(function(){b(this).val("["+h+"]")})};wpcf7.taggen.update.captcha=function(f){var e=wpcf7.taggen.compose("captchac",f);var a=wpcf7.taggen.compose("captchar",f);f.find("input.tag").val(e+" "+a)};wpcf7.taggen.compose=function(k,a){var o=a.find('input[name="name"]').val();var n=a.find(".scope."+k);if(!n.length){n=a}var p=[];n.find("input.option").not(":checkbox,:radio").each(function(d){var c=b(this).val();if(!c){return}if(b(this).hasClass("filetype")){c=c.split(/[,|\s]+/).join("|")}if(b(this).hasClass("color")){c="#"+c}if("class"==b(this).attr("name")){b.each(c.split(" "),function(f,e){p.push("class:"+e)})}else{p.push(b(this).attr("name")+":"+c)}});n.find("input:checkbox.option").each(function(c){if(b(this).is(":checked")){p.push(b(this).attr("name"))}});n.find("input:radio.option").each(function(c){if(b(this).is(":checked")&&!b(this).hasClass("default")){p.push(b(this).attr("name")+":"+b(this).val())}});if("radio"==k){p.push("default:1")}p=(p.length>0)?p.join(" "):"";var j="";if(n.find(':input[name="values"]').val()){b.each(n.find(':input[name="values"]').val().split("\n"),function(d,c){j+=' "'+c.replace(/["]/g,"&quot;")+'"'})}var l=[];b.each([k,o,p,j],function(c,d){d=b.trim(d);if(""!=d){l.push(d)}});l=b.trim(l.join(" "));l="["+l+"]";var m=n.find(':input[name="content"]').val();m=b.trim(m);if(m){l+=" "+m+" [/"+k+"]"}return l};wpcf7.taggen.normalize=function(d){var a=d.val();if(d.is('input[name="name"]')){a=a.replace(/[^0-9a-zA-Z:._-]/g,"").replace(/^[^a-zA-Z]+/,"")}if(d.is(".numeric")){a=a.replace(/[^0-9.-]/g,"")}if(d.is(".idvalue")){a=a.replace(/[^-0-9a-zA-Z_]/g,"")}if(d.is(".classvalue")){a=b.map(a.split(" "),function(c){return c.replace(/[^-0-9a-zA-Z_]/g,"")}).join(" ");a=b.trim(a.replace(/\s+/g," "))}if(d.is(".color")){a=a.replace(/[^0-9a-fA-F]/g,"")}if(d.is(".filesize")){a=a.replace(/[^0-9kKmMbB]/g,"")}if(d.is(".filetype")){a=a.replace(/[^0-9a-zA-Z.,|\s]/g,"")}if(d.is(".date")){if(!a.match(/^\d{4}-\d{2}-\d{2}$/)){a=""}}if(d.is(':input[name="values"]')){a=b.trim(a)}d.val(a);if(d.is(":checkbox.exclusive")){wpcf7.taggen.exclusiveCheckbox(d)}};wpcf7.taggen.exclusiveCheckbox=function(a){if(a.is(":checked")){a.siblings(":checkbox.exclusive").prop("checked",false)}};wpcf7.taggen.insert=function(a){b("textarea#wpcf7-form").each(function(){this.focus();if(document.selection){var g=document.selection.createRange();g.text=a}else{if(this.selectionEnd||0===this.selectionEnd){var f=b(this).val();var h=this.selectionEnd;b(this).val(f.substring(0,h)+a+f.substring(h,f.length));this.selectionStart=h+a.length;this.selectionEnd=h+a.length}else{b(this).val(b(this).val()+a)}}this.focus()})}})(jQuery);